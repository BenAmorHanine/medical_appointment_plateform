<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <h1>Create New Password</h1>
      <p>Enter a strong password for your account security</p>
    </div>

    @if (successMessage) {
      <div class="alert alert-success">
        âœ“ {{ successMessage }}
      </div>
    }

    @if (errorMessage) {
      <div class="alert alert-error">
        âœ— {{ errorMessage }}
      </div>
    }

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="password">New Password</label>
        <div class="password-input-wrapper">
          <input
            id="password"
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            placeholder="Enter new password"
            class="form-control"
            [class.is-invalid]="form.get('password')?.invalid && form.get('password')?.touched"
            [disabled]="isLoading"
          />
          <button
            type="button"
            class="password-toggle"
            (click)="togglePasswordVisibility()"
            [disabled]="isLoading"
          >
            {{ showPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>

        <div class="password-strength">
          <div class="strength-bar">
            <div
              class="strength-fill"
              [style.width.%]="passwordStrength"
              [ngClass]="getPasswordStrengthClass()"
            ></div>
          </div>
          <span class="strength-text" [ngClass]="getPasswordStrengthClass()">
            {{ getPasswordStrengthText() }}
          </span>
        </div>

        @if (form.get('password')?.invalid && form.get('password')?.touched) {
          <div class="error-text">
            @if (form.get('password')?.errors?.['required']) {
              Password is required
            }
            @if (form.get('password')?.errors?.['minlength']) {
              Password must be at least 8 characters long
            }
            @if (form.get('password')?.errors?.['passwordStrength']) {
              Password must contain uppercase, lowercase, numbers, and special characters
            }
          </div>
        }

        <div class="password-requirements">
          <p><strong>Password Requirements:</strong></p>
          <ul>
            <li [class.met]="hasUpperCase()">
              At least one uppercase letter (A-Z)
            </li>
            <li [class.met]="hasLowerCase()">
              At least one lowercase letter (a-z)
            </li>
            <li [class.met]="hasNumeric()">
              At least one number (0-9)
            </li>
            <li [class.met]="hasSpecialChar()">
              At least one special character
            </li>
            <li [class.met]="hasMinLength()">
              Minimum 8 characters
            </li>
          </ul>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <div class="password-input-wrapper">
          <input
            id="confirmPassword"
            [type]="showConfirmPassword ? 'text' : 'password'"
            formControlName="confirmPassword"
            placeholder="Re-enter password"
            class="form-control"
            [class.is-invalid]="form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched"
            [disabled]="isLoading"
          />
          <button
            type="button"
            class="password-toggle"
            (click)="toggleConfirmPasswordVisibility()"
            [disabled]="isLoading"
          >
            {{ showConfirmPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>

        @if (form.errors?.['passwordMismatch'] && form.touched) {
          <div class="error-text">
            Passwords do not match
          </div>
        }
      </div>

      <button
        type="submit"
        [disabled]="form.invalid || isLoading"
        class="btn btn-primary btn-block"
      >
        @if (!isLoading) {
          <span>Reset Password</span>
        }
        @if (isLoading) {
          <span class="spinner"></span>
          Resetting...
        }
      </button>
    </form>

    <div class="auth-footer">
      <p>Remember your password? <a routerLink="/auth/login">Sign in</a></p>
    </div>
  </div>
</div>
