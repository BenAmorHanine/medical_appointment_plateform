<!-- src/app/features/dashboard/components/dashboard.component.html -->

<section class="dashboard-hero">
  <div class="container">
    <div class="hero-content">
      <h1 class="hero-title">Admin Dashboard</h1>
      <p class="hero-subtitle">
        Overview, statistics, user management and notifications
      </p>
    </div>
  </div>
</section>

<section class="dashboard-main">
  <div class="container">

    <!-- Stats cards -->
    <div class="stats-grid" *ngIf="stats">
      <div class="stat-card">
        <h3>Total patients</h3>
        <p>{{ stats.totalPatients }}</p>
      </div>
      <div class="stat-card">
        <h3>Total doctors</h3>
        <p>{{ stats.totalDoctors }}</p>
      </div>
      <div class="stat-card">
        <h3>Total appointments</h3>
        <p>{{ stats.totalAppointments }}</p>
      </div>
      <div class="stat-card">
        <h3>Total consultations</h3>
        <p>{{ stats.totalConsultations }}</p>
      </div>
    </div>

    <!-- Charts placeholder -->
    <div class="charts-row">
      <div class="chart-card">
        <h3>Appointments overview</h3>
        <p class="chart-placeholder">Charts to be added here (ng2-charts / Chart.js).</p>
      </div>
    </div>

    <!-- Users management -->
    <div class="users-section">
      <h2>Users management</h2>

      <table class="users-table" *ngIf="users.length">
        <thead>
          <tr>
            <th>Username</th>
            <th>Email</th>
            <th>Role</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let u of users">
            <td>{{ u.username }}</td>
            <td>{{ u.email }}</td>
            <td>
              <select [ngModel]="u.role" (ngModelChange)="onChangeRole(u, $event)">
                <option value="patient">patient</option>
                <option value="doctor">doctor</option>
                <option value="admin">admin</option>
              </select>
            </td>
            <td>{{ u.createdAt | date:'short' }}</td>
            <td>
              <button class="btn-secondary" (click)="onDeleteUser(u)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>

      <p *ngIf="!users.length && !loadingUsers">No users found.</p>
    </div>

    <!-- Notification center -->
    <div class="notifications-section">
      <div class="notifications-header">
        <h2>Notifications center</h2>
        <button class="btn-secondary" (click)="onMarkAllRead()">
          Mark all as read ({{ unreadCount }} unread)
        </button>
      </div>

      <ul class="notifications-list" *ngIf="notifications.length">
        <li *ngFor="let n of notifications">
          <div class="notif-title">{{ n.title }}</div>
          <div class="notif-message">{{ n.message }}</div>
          <div class="notif-date">{{ n.createdAt | date:'short' }}</div>
        </li>
      </ul>

      <p *ngIf="!notifications.length && !loadingNotifications">
        No notifications yet.
      </p>
    </div>
  </div>
</section>
