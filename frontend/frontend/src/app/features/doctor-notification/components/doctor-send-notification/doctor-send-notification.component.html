<section class="notification-section">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8 col-md-10">
        <!-- Header Section -->
        <div class="notification-header text-center mb-5">
          <h2 class="section-title mb-3">
            Send <span class="gradient-text">Notification</span>
          </h2>
          <p class="section-subtitle">Send messages to your patients</p>
        </div>

        <div class="notification-card">
          <div class="card-header-modern">
            <div class="header-content">
              <div class="header-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div>
                <h3 class="header-title">Doctor â†’ Patient</h3>
                <p class="header-subtitle">Compose and send your message</p>
              </div>
            </div>
          </div>

          <div class="card-body-modern">
            <form #mailForm="ngForm" (ngSubmit)="submit(mailForm)">

              <!-- TYPE -->
              <div class="form-group-modern">
                <label class="form-label-modern">
                  <i class="fas fa-tag me-2"></i>Message Type
                </label>
                <select
                  class="form-control-modern"
                  name="type"
                  ngModel
                  (ngModelChange)="onTypeChange($event)"
                >
                  <option value="">Select message type</option>
                  <option value="reminder">ğŸ”” Appointment Reminder</option>
                  <option value="followup">ğŸ©º Post-consultation Follow-up</option>
                  <option value="cancel">âŒ Cancellation / Reschedule</option>
                </select>
              </div>

              <!-- NAME -->
              <div class="form-group-modern">
                <label class="form-label-modern">
                  <i class="fas fa-user me-2"></i>Patient Name
                </label>
                <input
                  type="text"
                  class="form-control-modern"
                  name="name"
                  ngModel
                  required
                  #nameInput="ngModel"
                  placeholder="Patient full name"
                />

                @if (nameInput.invalid && nameInput.touched) {
                  <div class="error-message">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Patient name is required
                  </div>
                }
              </div>

              <!-- EMAIL -->
              <div class="form-group-modern">
                <label class="form-label-modern">
                  <i class="fas fa-envelope me-2"></i>Patient Email
                </label>
                <input
                  type="email"
                  class="form-control-modern"
                  name="recipientEmail"
                  ngModel
                  required
                  email
                  #emailInput="ngModel"
                  placeholder="example@email.com"
                />

                @if (emailInput.invalid && emailInput.touched) {
                  <div class="error-message">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Please enter a valid email address
                  </div>
                }
              </div>

            <!-- SUBJECT -->
<div class="form-group-modern">
  <label class="form-label-modern">
    <i class="fas fa-heading me-2"></i>Subject
  </label>
  <input
    type="text"
    class="form-control-modern"
    name="subject"
    [ngModel]="defaultSubject()"
    (ngModelChange)="defaultSubject.set($event)"
    required
    placeholder="Email subject"
  />
</div>



              <!-- MESSAGE -->
             <div class="form-group-modern">
  <label class="form-label-modern">
    <i class="fas fa-comment-alt me-2"></i>Message
  </label>
  <textarea
    rows="6"
    class="form-control-modern form-control-textarea"
    name="message"
    [ngModel]="defaultMessage()"
    (ngModelChange)="defaultMessage.set($event)"
    required
    minlength="5"
    #messageInput="ngModel"
    placeholder="Write your message here..."
  ></textarea>

  @if (messageInput.invalid && messageInput.touched) {
    <div class="error-message">
      <i class="fas fa-exclamation-circle me-1"></i>
      Message must be at least 5 characters
    </div>
  }
</div>


              <!-- HIDDEN ROLE -->
              <input type="hidden" name="role" ngModel value="patient" />

              <button
  type="submit"
  class="btn-submit"
  [disabled]="mailForm.invalid || loading()"
>
  @if (!loading()) {
    <span>
      <i class="fas fa-paper-plane me-2"></i> Send Email
    </span>
  } @else {
    <span>
      <span class="spinner-border spinner-border-sm me-2"></span>
      Sending...
    </span>
  }
</button>


            </form>

            <!-- FEEDBACK -->
          @if (successMessage()) {
  <div class="alert-modern alert-modern-success mt-4">
    <i class="fas fa-check-circle me-2"></i>
    {{ successMessage() }}
  </div>
}

@if (errorMessage()) {
  <div class="alert-modern alert-modern-danger mt-4">
    <i class="fas fa-exclamation-circle me-2"></i>
    {{ errorMessage() }}
  </div>
}

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
